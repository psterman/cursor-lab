# 快速修复指南 - 上传功能

## 🎯 问题已修复

已成功修复"点击'选择文件夹'无法上传数据"的问题。

## 🆕 新增功能

### 1. 单文件上传
现在有两种上传方式：

**方式一：文件夹上传（推荐批量处理）**
- 点击"选择文件夹"按钮
- 选择 workspaceStorage 目录
- 自动扫描所有 `.vscdb` 文件

**方式二：单文件上传（推荐快速测试）**
- 点击"选择单个文件"按钮
- 选择一个或多个 `.vscdb` 文件
- 支持格式：`.vscdb`, `.db`, `.sqlite`, `.sqlite3`

### 2. 详细错误提示
如果上传失败，会显示具体的错误信息：
- ❌ "未找到 state.vscdb 文件"
- ❌ "未找到有效的数据库文件"
- ❌ "未找到任何对话数据"

### 3. 实时调试日志
打开浏览器控制台（F12），可以看到详细的处理过程。

## 🚀 立即测试

### 步骤 1：启动应用
```bash
# Windows
start.bat

# macOS/Linux
bash start.sh

# 或使用 npm
npm run dev
```

### 步骤 2：选择上传方式
- 如果是第一次使用，建议先试试"选择单个文件"
- 如果要分析所有数据，使用"选择文件夹"

### 步骤 3：查看结果
- 成功后自动显示分析报告
- 如果失败，查看红色错误提示

## 🔧 故障排查

### 问题 1：点击"选择文件夹"没反应

**原因**：浏览器不支持文件夹上传

**解决**：使用"选择单个文件"按钮，或换用 Chrome/Edge 浏览器

### 问题 2：显示"未找到 state.vscdb 文件"

**原因**：选择了错误的文件夹

**解决**：
1. 确保选择的是 `workspaceStorage` 文件夹本身
2. 或使用"选择单个文件"直接上传 `.vscdb` 文件

### 问题 3：上传后一直显示加载

**原因**：文件太大或 WebAssembly 加载失败

**解决**：
1. 打开控制台（F12）查看错误
2. 尝试上传更小的文件
3. 检查是否有网络问题（首次加载需要下载 Wasm 文件）

## 📊 性能参考

| 文件大小 | 预期时间 |
|---------|---------|
| < 1MB | < 1 秒 |
| 1-10MB | 1-5 秒 |
| 10-50MB | 5-20 秒 |
| > 50MB | 20-60 秒 |

## 🎯 快速测试

**最简单的测试方法**：

1. 找到一个 `.vscdb` 文件
2. 点击"选择单个文件"
3. 选择这个文件
4. 等待几秒钟

如果成功，你会看到：
- ✅ 统计卡片（对话次数、代码字符数等）
- ✅ 图表（热力图、饼图）
- ✅ 对话列表

## 📞 需要帮助？

### 查看日志
1. 按 F12 打开开发者工具
2. 切换到 Console 标签页
3. 查看以 `[Main]` 开头的日志

### 常见日志示例

**成功上传**：
```
[Main] 点击选择文件按钮
[Main] 处理文件上传，类型: file
[Main] 选择了 1 个文件
[Main] 单文件模式：找到 1 个数据库文件
[Main] 总共提取 123 条对话记录
```

**上传失败**：
```
[Main] 处理失败: Error: 未找到有效的数据库文件
```

### 附加信息

如果问题仍然存在，请提供：
1. 浏览器名称和版本
2. 控制台日志截图
3. 错误提示文字

## 📚 详细文档

- `README.md` - 完整使用文档
- `QUICKSTART.md` - 快速开始
- `TESTING.md` - 测试指南
- `FIX_SUMMARY.md` - 修复详情

---

**更新时间**：2025-01-12
**版本**：v1.1.0
