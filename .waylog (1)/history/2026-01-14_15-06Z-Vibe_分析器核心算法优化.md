# Vibe 分析器核心算法优化
_Exported on 01/14/2026 at 23:09:26 GMT+8 from Cursor via WayLog_


**User**

重构 vibeAnalyzerWorker.js 
核心算法：引入密度窗口、排位梯队与语义加权。
任务目标：优化 Vibe 分析器的精准度，使其不仅能识别语料，还能通过文本密度和梯队映射产生“竞技段位感”。
1. 引入密度窗口 (Density Windowing)：不要计算总分。请计算每千字有效载荷（Weighted Hits per 1k Characters）。引入“置信度系数”：若总字数不足 500 字，分数向 50 分强制收缩；若超过 2000 字，完全释放密度得分。
2. 模拟王者荣耀“排位分梯队” (Tiered Normalization)：使用 Sigmoid（S型曲线） 替代线性映射。分段锁定：40-65 分（青铜/白银）增长较快；85 分以上（王者）进入“指数阻力区”，每提升 1 分需要双倍的密度增长。设置 midpoint（50分中位值）为行业平均密度。
3. 语义权重矩阵 (Semantic Matrix)：区分噪音与神谕：手动将 L1 (专家词) 的权重提升至 L3 (常用词) 的 5 倍以上。连击加成 (Combo Bonus)：如果一个片段内同时命中“逻辑”与“细腻”词汇，给予 1.2 倍的系数加成，识别“高质量指令”。
请基于以上逻辑，重写 calculateRawScores 和 normalizeScores 函数。
🛠️ 指导性方案：三维算法
拆解第一维：密度窗口 (Density Windowing) —— 解决“话痨刷分”
核心逻辑：得分不取决于你命中了多少次，而取决于你说话的“含金量”。字数归一化：定义 $Density = \frac{WeightedHits}{TotalChars} \times 1000$。窗口保护：防止用户发一个词（命中率100%）就得满分。算法实现：引入 Math.atan(TotalChars / 500) 作为置信度权重。
第二维：排位分梯队 (Tiered Normalization) —— 建立“竞技感”
核心逻辑：模仿游戏数值策划，让 90 分成为真正的“神坛”。S 曲线映射：使用 $Score = \frac{100}{1 + e^{-k(x - x0)}}$。荣耀王者门槛：钻石及以下 (40-80)：曲线斜率大，进步明显。王者 (90+)：引入 Math.pow(overflow, 0.5)，对超出部分进行开方压缩。UI 配合：在 index.html 中，雷达图的边缘应增加 “流光效果” 或 “段位边框”。
第三维：语义权重矩阵 —— 识别“灵魂深度”
核心逻辑：给词汇打上“稀缺度”标签。权重差异化：噪音词 (L3)：权重 1。如“好的”、“改下”。神谕词 (L1)：权重 10+。如“幂等性”、“抽象层”、“时空复杂度”。

---


**Cursor**

查看 `vibeAnalyzerWorker.js` 的现有实现：

---
